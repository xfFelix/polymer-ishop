<html><head></head><body><dom-module id="lt-choose-shop-page"><template><style include="lt-style">:host{width:100%;min-height:500px;display:block;padding:15px 25px;box-sizing:border-box;background:#fff;--border-style:1px solid #ddd;}.pageContainer{min-height:500px;}.header{color:rgba(0,0,0,0.6);width:100%;}.header span:last-child{color :#6abaff;}.order_box{margin-top:20px;}.car_table table{width:100%;border-collapse:collapse;margin:0 auto;margin-top:20px;}td .imgBox{width:25%;}table tr td{border :1px solid #ddd;padding:10px;min-width:120px;text-align:center;box-sizing:border-box;}table thead{background:#F5F5F5;}table tbody{background:#fff;}table tr td.detail_td{border-top:none;border-right:none;display:flex;align-items:center;}.dec{font-weight:600;margin-left:20px;}.brand{display:inline-block;}.brand::after{content:" | ";}.series{display:inline-block;}.model{display:block;color:#999999;font-weight:300;margin-top:8px;}.price{font-size:30px;color:red;}.price::before{content:"￥";font-size:14px;color:#4A4A4A;}.price::after{content:"万";font-size:14px;color:#4A4A4A;}.shop_box{margin-top:20px;display:flex;justify-content:space-between;width:100%;margin-bottom:10px;}.shop_list{width:35%;}.shop_box ul li{padding:15px;border:var(--border-style);display:flex;align-items:center;justify-content:flex-start;}.shop_left{display:flex;flex-flow:column wrap;}.num{width:20px;height:20px;text-align:center;background:#ffb800;color:#fff;border:1px solid transparent;border-radius:10px;align-self:flex-start;position:relative;}.num::after{content:"";border-right:8px solid transparent;border-left:8px solid transparent;border-top:10px solid #ffb800;position:absolute;bottom:-8px;right:2px;}.distance{font-size:1%;color:#ff0000ad;margin-top:20%;white-space:nowrap;}.distance::after{content:'km';}.shop_detail{width:75%;padding:0 5px;}.shop_name{font-weight:800;font-size:18px;}.shop_address{font-weight:300;font-size:14px;}.choose_button{background:#f00;color:#fff;padding:5px;min-width:36px;}#mapContainer{width:62%;height:400px;align-self:flex-end;}.popContainer{padding:5px;display:flex;flex-direction:column;align-items:flex-start;}.popContainer .buttons{margin-top:10px;align-self:flex-end;}.popContainer .confirmText{font-size:24px;font-weight:500;}@media screen and (max-width:620px){:host{padding:10px;}table tr td.detail_td{flex-direction:column;}td .imgBox ,td .dec{width:100%;margin:0;}.shop_box{flex-direction:column;}.shop_box .shop_list{width:100%;}.shop_box #mapContainer{width:100%;align-self:center;}}</style><div class="pageContainer"><div class="header">当前位置：<span>首页</span> &gt; <span>我的订单</span> &gt; <span>选择附近的车行</span></div><div class="order_box"><div class="car_table" id="car_table"><table><thead><tr><td>产品</td><td>价格</td></tr></thead><tbody><tr><td class="detail_td"><div class="imgBox" style="background: url(../../../images/default_bg.jpg);"><img src$="{{shop_car_detail.defaultImgUrl}}" width="100%"></div><div class="dec"><span class="brand">{{shop_car_detail.vehicleBrandName}}</span> <span class="series">{{shop_car_detail.vehicleSeriesName}}</span> <span class="model">{{shop_car_detail.vehicleModelName}}</span></div></td><td><div class="price">{{shop_car_detail.price}}</div></td></tr></tbody></table></div></div><div class="shop_box"><div class="shop_list"><ul><template is="dom-repeat" items="{{shopList}}"><li><div class="shop_left"><div class="num">{{couIndex(index)}}</div><em class="distance">{{_computeKm(item.distance)}}</em></div><div class="shop_detail"><div class="shop_name">{{item.shopName}}</div><div class="shop_address">{{item.shopAddress}}</div></div><div class="choose_button" on-click="_chooseShop">选择</div></li></template></ul></div><div id="mapContainer"><iframe id="iframe" src="/src/lt-auto/map.html" frameborder="0" width="100%" height="100%"></iframe></div></div></div><lt-pop opened="{{confirmPopBoo}}"><div class="popContainer"><div class="confirmText">是否选择该店铺?</div><div class="buttons"><lt-button on-click="_concelSelect">取消</lt-button><lt-button on-click="_confirmShop">确定</lt-button></div></div></lt-pop><iron-ajax id="getShopList" method="POST" headers="{{header}}" body="{}" url="{{_calUserUrl('order/shopping/getShopList')}}" content-type="application/json" handle-as="json" on-response="_responShopList"></iron-ajax><iron-ajax id="saveSalesArea" method="POST" headers="{{header}}" url="{{_calUserUrl('order/shopping/saveSalesArea')}}" content-type="application/json" handle-as="json" on-response="_responSaveArea"></iron-ajax></template><script>var ltChooseShopPage=function(a){function b(){return babelHelpers.classCallCheck(this,b),babelHelpers.possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return babelHelpers.inherits(b,a),babelHelpers.createClass(b,[{key:"_chooseShop",value:function(a){var b=a.model.__data.item;this.selectedShop=b,this.confirmPopBoo=!0}},{key:"_concelSelect",value:function(){this.confirmPopBoo=!1}},{key:"_confirmShop",value:function(){this.$.saveSalesArea.body={datas:[{tabSysShopId:this.selectedShop.tabSysShopId,vehicleSalesUid:this.shop_car_detail.vehicleSalesUid}]},this.$.saveSalesArea.generateRequest()}},{key:"_responSaveArea",value:function(a){1==a.detail.response.status&&(this.confirmPopBoo=!1,this.dispatchEvent(new CustomEvent("confirm",{detail:{msg:"\u4FDD\u5B58\u6210\u529F"},bubbles:!0,composed:!0})),location.hash="#/order")}},{key:"couIndex",value:function(a){return++a}},{key:"_responShopList",value:function(a){this.shopList=a.detail.response.shopList||[];var b=[];this.shopList.forEach(function(a,c){b.push({ind:c+1,x:a.locationX,y:a.locationY})});var c=this.$.iframe.contentWindow;c.addEventListener("load",c.setShop(b))}},{key:"_computeKm",value:function(a){return a/1e3}},{key:"ready",value:function(){babelHelpers.get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"ready",this).call(this)}},{key:"getDates",value:function(){var a=this;window.addEventListener("message",function(b){var c=b.data[0],d=b.data[1];a.$.getShopList.body={longitude:c,latitude:d},a.$.getShopList.generateRequest()})}},{key:"show",value:function(){if(this.style.display="block",header["X-CustomToken"]){var a=this.$.iframe.contentWindow;a.addEventListener("load",this.getDates()),this.shop_car_detail=JSON.parse(localStorage.getItem("shop_car_detail"))}else this.dispatchEvent(new CustomEvent("confirm",{detail:{msg:"\u8BF7\u5148\u767B\u5F55!"},bubbles:!0,composed:!0})),setTimeout(function(){location.hash="#/home"},2e3)}},{key:"hide",value:function(){this.dispatchEvent(new CustomEvent("hide",{})),this.style.display="none"}}],[{key:"is",get:function(){return"lt-choose-shop-page"}},{key:"properties",get:function(){return{shopList:Array,confirmPopBoo:{type:Boolean,value:!1}}}},{key:"observers",get:function(){return[]}}]),b}(ltMixin(Polymer.Element));customElements.define(ltChooseShopPage.is,ltChooseShopPage);</script></dom-module></body></html>