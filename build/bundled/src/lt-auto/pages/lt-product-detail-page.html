<html><head></head><body><dom-module id="lt-product-detail-page"><template><style include="lt-style">:host{width:100%;min-height:500px;display:block;padding:15px 20px;box-sizing:border-box;background-color:#fff;}lt-num-count{padding:0px 10px;}.addCart{color:var(--app-primary-orange);background:#fff;border:1px solid var(--app-primary-orange);}.pageContainer{display:flex;justify-content:space-between;font-size:16px;}.imgBox , .detail{width:48%;height:30%;}.imgBox{padding:1%;margin-top:25px;border:1px solid #ddd;}l2t-paper-slider{--paper-slide-height:auto;}paper-slide{overflow-y:hidden;}.imgBox img{width:100%;height:auto;}.type,.num,.dec,.action{margin:30px 0;color:#666666;}.detail .type .typeItem{background:#d8d8d8;color:#fff;padding:7px;margin-right:1%;}.detail .type .typeItem.iron-selected{background:#D0021B;}.detail{padding:0 30px;}.price{font-size:40px;white-space:nowrap;color:red;}.price::before{content:"￥";font-size:20px;color:#4A4A4A;}.action{display:flex;justify-content:space-between;}.buttons span{display:inline-flex;padding:8px;border-radius:4px;}.collection{border:2px solid #F5A623;color:#F5A623;}.shopping{background:var(--app-primary-red);border:2px solid var(--app-primary-red);border-radius:2px;color:#fff;}.buttons img{width:20px;height:20px;}@media screen and (max-width:620px){:host{padding:10px;}.pageContainer{flex-direction:column;}.imgBox , .detail{width:98%;padding:1%;}.price{font-size:30px;}.buttons img{display:none;}.imgBox{margin-top:0;}}@media screen and (max-width:900px) and (min-width:621px){:host{padding:10px;}.pageContainer{flex-direction:column;}.imgBox , .detail{width:98%;padding:1%;}.imgBox{margin-top:0;}}</style><div class="content"><div class="pageContainer"><div class="imgBox"><l2t-paper-slider auto-progress="" slide-duration="2" total-slides="[[data.productImgUrl.length]]" position="{{sliderNum}}"><template is="dom-repeat" items="{{data.productImgUrl}}"><paper-slide><img src="{{item}}"></paper-slide></template></l2t-paper-slider></div><div class="detail"><h2 class="title">{{data.productName}}</h2><div class="type"><span>选择种类:</span><iron-selector selected="{{selectType}}" fallback-selection="0"><template is="dom-repeat" items="{{data.colorBeanList}}"><span class="typeItem">{{item.colorName}}</span></template></iron-selector></div><div class="num"><span>数量:</span><lt-num-count total="{{stock}}" num="{{selectedNum}}"></lt-num-count><span>库存{{stock}}件</span></div><paper-textarea readonly="" class="dec" value="{{data.productDescription}}"></paper-textarea><div class="action"><div class="price">{{price}}</div><div class="buttons"><span class="addCart" on-click="_addCart"><img class="btn_icon" src="./images/add.svg">加入购物车</span> <span class="shopping" on-click="_purchase"><img class="btn_icon" src="./images/shopping-cart.svg">立即抢购</span></div></div></div></div></div><lt-pop opened="{{isOpened}}"><lt-purchase-element id="purchaseEle" wechat-code="{{wechatCode}}" on-cancel="_cancel" ali-code="{{aliCode}}" status-id="{{transactionId}}" on-success="_paySuccess"></lt-purchase-element></lt-pop><iron-ajax id="getProductDetail" method="POST" url="{{_calUserUrl('product/findProductDetailsByUid')}}" content-type="application/json" handle-as="json" on-response="_responseProduct"></iron-ajax><iron-ajax id="saveCart" method="POST" headers="{{header}}" url="{{_calUserUrl('order/shopping/saveCart')}}" content-type="application/json" handle-as="json" on-response="_responseSaveCart"></iron-ajax><iron-ajax id="createOrder" method="POST" headers="{{header}}" url="{{_calUserUrl('order/shopping/createOrder')}}" content-type="application/json" handle-as="json" on-response="_responsOrder"></iron-ajax><iron-ajax id="getQrcode" method="POST" url="{{_calPayUrl('shop/qrCodePay')}}" content-type="application/json" handle-as="json" on-response="_responQrcode"></iron-ajax></template><script>var ltProductDetailPage=function(a){function b(){return babelHelpers.classCallCheck(this,b),babelHelpers.possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return babelHelpers.inherits(b,a),babelHelpers.createClass(b,[{key:"_addCart",value:function(){header["X-CustomToken"]?0<this.selectedNum?(this.$.saveCart.body={data:{type:this.data.colorBeanList[this.selectType].colorName,productUid:this.data.uid,num:this.selectedNum},userName:header["X-USERNAME"]},this.$.saveCart.generateRequest()):this.dispatchEvent(new CustomEvent("confirm",{detail:{msg:"\u8D2D\u4E70\u6570\u91CF\u4E0D\u80FD\u4E3A0"},bubbles:!0,composed:!0})):this.dispatchEvent(new CustomEvent("login",{}))}},{key:"_responseSaveCart",value:function(a){1==a.detail.response.status&&this.dispatchEvent(new CustomEvent("confirm",{detail:{msg:"\u6DFB\u52A0\u6210\u529F\uFF01"},bubbles:!0,composed:!0}))}},{key:"_purchase",value:function(){header["X-CustomToken"]?(0<this.selectedNum?(this.$.createOrder.body={datas:[{type:this.data.colorBeanList[this.selectType].colorName,productUid:this.data.uid,num:this.selectedNum}]},this.$.createOrder.generateRequest()):this.dispatchEvent(new CustomEvent("confirm",{detail:{msg:"\u8D2D\u4E70\u6570\u91CF\u4E0D\u80FD\u4E3A0"},bubbles:!0,composed:!0})),this.isOpened=!0):this.dispatchEvent(new CustomEvent("login",{}))}},{key:"_responsOrder",value:function(a){var b=a.detail.response;this.transactionId=b.transactionId,this.$.getQrcode.body={outTradeNumber:b.transactionId,body:b.attach},this.$.getQrcode.generateRequest()}},{key:"_responQrcode",value:function(a){for(var b=a.detail.response,c=0;c<b.length;c++)"WeChatPay"==b[c].platform&&(this.wechatCode=b[c].qrCodeByte),"AliPay"==b[c].platform&&(this.aliCode=b[c].qrCodeByte);this.isOpened=!0}},{key:"_cancel",value:function(){this.isOpened=!1}},{key:"_paySuccess",value:function(){}},{key:"_checkId",value:function(a,b){a&&"product-detail"==b&&(this.$.getProductDetail.body={data:{uid:a}},this.$.getProductDetail.generateRequest())}},{key:"_responseProduct",value:function(a){this.data=a.detail.response.datas[0]}},{key:"_checkStock",value:function(a){this.stock=this.data.colorBeanList[a].stock,this.price=this.data.colorBeanList[a].price,0==this.stock&&(this.selectedNum=0)}},{key:"show",value:function(){this.style.display="block"}},{key:"hide",value:function(){this.dispatchEvent(new CustomEvent("hide",{}),!1),this.style.display="none"}}],[{key:"is",get:function(){return"lt-product-detail-page"}},{key:"properties",get:function(){return{productId:{type:String},page:{type:String},data:Object,selectType:{type:String,observer:"_checkStock"}}}},{key:"observers",get:function(){return["_checkId(productId,page)"]}}]),b}(ltMixin(Polymer.Element));customElements.define(ltProductDetailPage.is,ltProductDetailPage);</script></dom-module></body></html>