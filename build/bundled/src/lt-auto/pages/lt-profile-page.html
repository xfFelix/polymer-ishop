<html><head></head><body><dom-module id="lt-profile-page"><template><style include="lt-style">:host{width:100%;min-height:500px;display:block;padding:15px 25px;box-sizing:border-box;background:#fff;}.pageContainer{min-height:500px;display:flex;flex-direction:column;align-items:center;}.header{color:rgba(0,0,0,0.6);text-align:center;width:100%;}.header span:last-child{color :var(--app-primary-blue);}.avatar{margin-top:10px;width:100px;height:100px;border:1px solid #dedede;border-radius:100px;box-shadow:0px 2px 2px #dedede;position:relative;font-size:14px;font-weight:bold;overflow:hidden;}.avatar img{width:100%;height:100%;}.avatar .editAva{position:absolute;bottom:2px;background:#dedede;height:100%;width:100%;opacity:0;border:1px;border-radius:50px;display:flex;justify-content:center;align-items:flex-end;}.avatar .editAva:hover{opacity:0.7;}.avatar input{opacity:0;height:100%;position:absolute;width:100%;bottom:0;cursor:pointer;}.avatar span{width:80px;text-align:center;}.profileInfo{display:flex;flex-direction:column;align-items:center;}.infoFlexBox>*{display:inline-block;}vaadin-combo-box{margin:0;width:100%;}@media screen and (max-width:620px){}</style><div class="pageContainer"><div class="header">当前位置：<span>首页</span> &gt; <span>个人信息</span></div><div class="avatar"><img id="img" alt=""><div class="editAva"><input id="upload" type="file" on-change="_avatarChange"> <span>编辑头像(png格式)</span></div></div><div class="profileInfo"><div class="infoFlexBox"><lt-input label="名*" value="{{userInfo.firstName}}" required=""></lt-input><lt-input label="姓*" value="{{userInfo.lastName}}" required=""></lt-input></div><lt-input label="电话" value="{{userInfo.mobile}}"></lt-input><vaadin-combo-box label="性别" items="{{genderItems}}" value="{{userInfo.gender}}"></vaadin-combo-box><lt-input label="邮箱" value="{{userInfo.email}}"></lt-input></div><div class="saveButton"><lt-button on-click="_saveInfo">保存</lt-button></div></div><iron-ajax id="getUserInfo" method="POST" headers="{{header}}" url="{{_calUserUrl('member/findById')}}" content-type="application/json" on-response="_responFind"></iron-ajax><iron-ajax id="saveUserInfo" method="POST" headers="{{header}}" url="{{_calUserUrl('member/save')}}" body="{}" content-type="application/x-www-form-urlencoded" handle-as="json" on-response="_responSaveUser"></iron-ajax></template><script>var ltProfilePage=function(a){function b(){return babelHelpers.classCallCheck(this,b),babelHelpers.possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return babelHelpers.inherits(b,a),babelHelpers.createClass(b,[{key:"_responFind",value:function(a){1==a.detail.response.status&&(this.userInfo=a.detail.response.datas[0],this.$.img.src=a.detail.response.ossResponseList[0].url)}},{key:"_saveInfo",value:function(){this.userInfo.firstName&&this.userInfo.lastName&&(this.$.saveUserInfo.body={username:header["X-USERNAME"],firstName:this.userInfo.firstName.toString(),lastName:this.userInfo.lastName.toString(),mobile:this.userInfo.mobile,gender:this.userInfo.gender,email:this.userInfo.email},this.$.saveUserInfo.generateRequest())}},{key:"_responSaveUser",value:function(a){1==a.detail.response.status&&(this.dispatchEvent(new CustomEvent("confirm",{detail:{msg:"\u4FDD\u5B58\u6210\u529F!"},bubbles:!0,composed:!0})),setTimeout(function(){},2e3))}},{key:"show",value:function(){this.style.display="block",header["X-CustomToken"]?(this.$.getUserInfo.body={username:header["X-USERNAME"]},this.$.getUserInfo.generateRequest()):(this.dispatchEvent(new CustomEvent("confirm",{detail:{msg:"\u8BF7\u5148\u767B\u5F55!"},bubbles:!0,composed:!0})),setTimeout(function(){location.hash="#/home"},2e3))}},{key:"hide",value:function(){this.dispatchEvent(new CustomEvent("hide",{}),!1),this.style.display="none"}},{key:"_avatarChange",value:function(){var a=this,b=this.$.upload.files[0],c=this.getObjectURL(b);this.$.img.src=c;var d=new FormData;d.append("file",b),d.append("fileType","MEMBER_AVATAR"),d.append("mobile",a.userInfo.mobile||""),d.append("gender",a.userInfo.gender||""),d.append("email",a.userInfo.email||""),d.append("username",a.userInfo.username||""),d.append("lastName",a.userInfo.lastName||""),d.append("firstName",a.userInfo.firstName||"");var e=new XMLHttpRequest;e.open("post",a._calUserUrl("member/save"),!0),e.setRequestHeader("X-USERNAME",header["X-USERNAME"]),e.setRequestHeader("X-CustomToken",header["X-CustomToken"]),e.onload=a.uploadComplete.bind(a),e.onerror=a.uploadFailed,e.send(d)}},{key:"uploadComplete",value:function(a){var b=JSON.parse(a.target.response);1==b.status&&this.dispatchEvent(new CustomEvent("confirm",{detail:{msg:"\u4E0A\u4F20\u6210\u529F!"},bubbles:!0,composed:!0}))}},{key:"uploadFailed",value:function(a){console.log(a)}},{key:"getObjectURL",value:function(a){var b=null;return void 0==window.createObjectURL?void 0==window.URL?void 0!=window.webkitURL&&(b=window.webkitURL.createObjectURL(a)):b=window.URL.createObjectURL(a):b=window.createObjectURL(a),b}}],[{key:"is",get:function(){return"lt-profile-page"}},{key:"properties",get:function(){return{genderItems:{type:Array,value:function(){return[{label:"\u7537",value:"\u7537"},{label:"\u5973",value:"\u5973"}]}}}}},{key:"observers",get:function(){return[]}}]),b}(ltMixin(Polymer.Element));customElements.define(ltProfilePage.is,ltProfilePage);</script></dom-module></body></html>